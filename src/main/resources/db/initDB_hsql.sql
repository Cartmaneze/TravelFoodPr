DROP TABLE MEALS_WITH_WEIGHT IF EXISTS;
DROP TABLE DAYS IF EXISTS;
DROP TABLE JOURNEY IF EXISTS;
DROP TABLE MEALS IF EXISTS;
DROP SEQUENCE GLOBAL_SEQ IF EXISTS;

CREATE SEQUENCE GLOBAL_SEQ AS INTEGER START WITH 100000;

CREATE TABLE MEALS (
  id          INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
  name        VARCHAR(255) NOT NULL,
  calories    INTEGER NOT NULL
);

CREATE TABLE JOURNEY
(
  id         INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
  name       VARCHAR(255) NOT NULL
);

CREATE TABLE DAYS
(
  id         INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
  name       VARCHAR(255) NOT NULL,
  journey_id  INTEGER NOT NULL,
  FOREIGN KEY (journey_id) REFERENCES journey (id) ON DELETE CASCADE
);

CREATE TABLE MEALS_WITH_WEIGHT (
  id          INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
  id_table    INTEGER NOT NULL,
  weight      INTEGER NOT NULL,
  day_id      INTEGER NOT NULL,
  meal_id     INTEGER NOT NULL,
  FOREIGN KEY (day_id) REFERENCES days (id) ON DELETE CASCADE,
  FOREIGN KEY (meal_id) REFERENCES meals (id) ON DELETE CASCADE
);
